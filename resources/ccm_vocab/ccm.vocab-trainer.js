ccm.component({name:"vocab-trainer",config:{key:"vocab",html:[ccm.store,{local:"http://derdanielb.github.io/vocat/resources/ccm_vocab/templates.json"}],style:[ccm.load,"http://derdanielb.github.io/vocat/resources/ccm_vocab/style.css"],store:[ccm.store,{url:"ws://ccm2.inf.h-brs.de/index.js",store:"vokabeltrainer"}],user:[ccm.instance,"http://kaul.inf.h-brs.de/ccm/components/user2.js"]},Instance:function(){var e=this;e.render=function(t){var n=ccm.helper.element(e);e.vocfield&&(e.key=e.vocfield),console.log(e.key),e.store.get(e.key,function(r){function l(r){var l=ccm.helper.html(e.html.get("main"));n.html(l),n.find("div#currcat").html("Current category: "+e.vocfield);var a=ccm.helper.html(e.html.get("content")),o=ccm.helper.html(e.html.get("nav")),i=ccm.helper.html(e.html.get("nav-add")),c=ccm.helper.html(e.html.get("nav-train")),m=ccm.helper.html(e.html.get("nav-show")),p=ccm.helper.html(e.html.get("nav-reset")),s=ccm.helper.html(e.html.get("nav-delete")),h=ccm.helper.html(e.html.get("subnav-add")),d=ccm.helper.html(e.html.get("subnav-card")),u=ccm.helper.html(e.html.get("card")),f=ccm.helper.html(e.html.get("show")),v=ccm.helper.html(e.html.get("reset-text")),g=i.find("form")[0],y=c.find("form")[0],b=m.find("form")[0],w=p.find("form")[0],k=s.find("form")[0],x=h.find("form")[0],S=d.find("form")[0],_=h.find("input")[0],j=h.find("input")[1],C=d.find("input")[0],M=$(f.find("ol")[0]);l.append(o),l.append(a),o.append(i),o.append(c),o.append(m),o.append(p),o.append(s),data=r,g.onsubmit=function(){return a.empty(),a.append(h),x.onsubmit=function(){return""==_.value?_.nextSibling.style.display="block":_.nextSibling.style.display="none",""==j.value?j.nextSibling.style.display="block":j.nextSibling.style.display="none",""!=_.value&&""!=j.value&&(r.pairs[r.pairs.length]={word:_.value,translation:j.value,known:!1},_.value="",j.value=""),e.store.set(r,function(){}),!1},!1},y.onsubmit=function I(){a.empty(),a.append(u),a.append(d),u.empty();var t,n,l=r.pairs.filter(function(e){return 0==e.known});if(l.length>0){var o=Math.floor(Math.random()*l.length);n=l[o],t=ccm.helper.html(e.html.get("word"),{word:ccm.helper.val(n.word)}),$(S).show()}else t=ccm.helper.html(e.html.get("no_unknown_words")),$(S).hide();return u.append(t),S.onsubmit=function(){var t=C.nextSibling.nextSibling;return""==C.value?(t.style.display="block",t.style.margin="0"):(t.style.display="none",n.known=C.value==n.translation,C.value="",t.style.display="none",e.store.set(r,function(){I()})),!1},!1},b.onsubmit=function(){a.empty(),a.append(f),M.empty();for(var t=0;t<r.pairs.length;t++){var n=r.pairs[t],l=ccm.helper.html(e.html.get("word-pair"),{word:ccm.helper.val(n.word),translation:ccm.helper.val(n.translation)});M.append(l)}return!1},w.onsubmit=function(){a.empty();for(var t=0;t<r.pairs.length;t++)r.pairs[t].known=!1;return e.store.set(r,function(){}),a.append(v),!1},k.onsubmit=function N(){a.empty(),a.append(f),M.empty();for(var t=0;t<r.pairs.length;t++){var n=r.pairs[t],l=ccm.helper.html(e.html.get("word-pair-delete"),{word:ccm.helper.val(n.word),translation:ccm.helper.val(n.translation)});M.append(l);var o=l.find("form")[0];$(o).append(ccm.helper.html(e.html.get("identifier"),{hidden:t})),o.onsubmit=function(){var t=this,n=t.childNodes.item(1).textContent,l=r.pairs.filter(function(e){return e.word!=r.pairs[n].word});return r.pairs=l,e.store.set(r,function(){N()}),!1}}return!1},t&&t()}null===r?e.store.set({key:e.key,pairs:[]},l):l(r)})}}});